name: molecule test

on:
    push:
        branches:
            - master
            - develop
    schedule:
        - cron: '0 4 * * 0'

jobs:
    test:
        runs-on: ubuntu-latest
        strategy:
            matrix:
              config:
                - image: monolithprojects/systemd-centos7
                  tag: latest
                - image: monolithprojects/systemd-centos8
                  tag: latest
                - image: monolithprojects/systemd-ubuntu16
                  tag: latest
                - image: monolithprojects/systemd-ubuntu18
                  tag: latest
        steps:
          - name: checkout
            uses: actions/checkout@v2
            with:
              path: "${{ github.repository }}"
          - name: molecule
            uses: robertdebock/molecule-action@1.1.1
            with:
              image: ${{ matrix.config.image }}
              tag: ${{ matrix.config.tag }}
              options: "--parallel all"
